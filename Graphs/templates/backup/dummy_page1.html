<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>GHC</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600">
    <link rel="stylesheet" href="../static/css/css/fontawesome.min.css">
    <link rel="stylesheet" href="../static/css/css/fullcalendar.min.css">
    <link rel="stylesheet" href="../static/css/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/css/tooplate.css">
    <link rel="stylesheet" href="../static/css/css/styling.css">
</head>
<style>
.line {
  fill: none;
  stroke: steelblue;
  stroke-width: 2px;
}
.axis { font: 13px Verdana;
/* font-weight:4px; */
 }




th {
	/* background: url(https://jackrugile.com/images/misc/noise-diagonal.png), linear-gradient(#777, #444);  */
    background-color:#1CBC9B;
  
	 border-left: 1px solid #555;
	border-right: 1px solid #777;
	border-top: 1px solid #555;
	border-bottom: 1px solid #333;
	box-shadow: inset 0 1px 0 #999;
	color:white;
    font-weight: bold;
	/* padding: 10px 15px; */
	position: relative;
    text-shadow: 0 1px 0 #000;	
    font-size: 18px;
}

 th:after {
	background: linear-gradient(rgba(255,255,255,0), rgba(255,255,255,.08));
	content: '';
	display: block;
	height: 25%;
	left: 0;
	margin: 1px 0 0 0;
	position: absolute;
	top: 25%;
	width: 100%;
}

#id_of_table th:first-child {
	border-left: 1px solid #777;	
	box-shadow: inset 1px 1px 0 #999;
}

#id_of_table th:last-child {
	box-shadow: inset -1px 1px 0 #999;
}

 td {
	border-right: 1px solid #fff;
	border-left: 1px solid #e8e8e8;
	border-top: 1px solid #fff;
	border-bottom: 1px solid #e8e8e8;
	padding: 10px 15px;
	position: relative;
    transition: all 300ms;
    font-size: 15px;
}
/* 
#id_of_table td:first-child {
	box-shadow: inset 1px 0 0 #fff;
}	

#id_of_table td:last-child {
	border-right: 1px solid #e8e8e8;
	box-shadow: inset -1px 0 0 #fff;
}	

#id_of_table tr {
	background: url(https://jackrugile.com/images/misc/noise-diagonal.png);	
}

#id_of_table tr:nth-child(odd) td {
	background: #f1f1f1 url(https://jackrugile.com/images/misc/noise-diagonal.png);	
}

#id_of_table tr:last-of-type td {
	box-shadow: inset 0 -1px 0 #fff; 
}

#id_of_table tr:last-of-type td:first-child {
	box-shadow: inset 1px -1px 0 #fff;
}	

#id_of_table tr:last-of-type td:last-child {
	box-shadow: inset -1px -1px 0 #fff;
}	 */
/* 
tbody:hover td {
	color: transparent;
	text-shadow: 0 0 3px #aaa;
} */

/* tbody:hover tr:hover td {
	color: #444;
	text-shadow: 0 1px 0 #fff;
} */
input[type="text"], textarea {

background-color : #f5f5f5; 
border:0px;
/* width:300px; */
/* height:40px; */

}
#id_of_table input:focus {
/* outline:none; */
border: 0;
outline: none
}
    #date
        {
            padding-left:10%;
        }
        p{
            font-size:20px;
        }
   



        #navbarSupportedContent a:hover {background-color: #ddd;}

        .col-12:hover #navbarSupportedContent {display: block;}

    
 </style>
<body id="reportsPage" onload="table_data('30/08/2019');document.getElementById('dt').value='30/08/2019';">
    <div class="" id="home">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <nav class="navbar navbar-expand-xl navbar-light bg-light">
                        <a class="navbar-brand" href="#">
                            <!-- <i class="fas fa-3x fa-tachometer-alt tm-site-icon"></i> -->
                            <img src="../static/images/ghclogo.png" height=70 width=70>
                            <h1 class="tm-site-title mb-0">GHC</h1>
                        </a>
                        <button class="navbar-toggler ml-auto mr-0" type="button"id="dropbtn" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                                aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon" ></span>
                            </button>
            
                        <div class="collapse navbar-collapse" id="navbarSupportedContent">
                            <ul class="navbar-nav mx-auto">
                                <li class="nav-item">
                                    <a class="nav-link active" href="{% url 'firstpage'%}">Page1
                                        <span class="sr-only">(current)</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <li class="nav-item">
                                        <a class="nav-link "  href="{% url 'secondpage'%}">Page2
                                           
                                        </a>
                                    </li>
                                   
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" href="{% url 'thirdpage'%}">Page3</a>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link"  href="{% url 'fourthpage'%}">Page4</a>
                                </li>
                                <li class="nav-item ">
                                    <a class="nav-link"  href="{% url 'fifthpage'%}">Page5</a>
                    
                                </li>
                                <li class="nav-item ">
                                    <a class="nav-link" href="{% url 'sixthpage'%}">Page6</a>
                    
                                </li>
                            </ul>
                            <ul class="navbar-nav">
                                <li class="nav-item">
                                    <a class="nav-link d-flex" href="{% url 'logout'%}">
                                        <i class="far fa-user mr-2 tm-logout-icon"></i>
                                        <span>Logout</span>
                            
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
            <!-- row -->
            <div class="row tm-content-row tm-mt-big">
                <div class="tm-col tm-col-big">
                    <div class="bg-white tm-block h-100 centered " id="centered">
                        <h2 class="tm-block-title"> Growth of $1000-Since Inception</h2>
                       

                            <!-- <svg style="width:100%;height:100%" class="centered"  id="centered"></svg> -->
                            <script src="https://d3js.org/d3.v4.min.js"></script>
                            <script>
                            
                            // // set the dimensions and margins of the graph
                            var margin = {top: 40, right: 20, bottom: 30, left: 100},
                                width = 550 - margin.left - margin.right,
                                height =400 - margin.top - margin.bottom;
                            
                            // parse the date / time
                            // var parseTime = d3.timeParse("%Y-%m");
                            var parseTime = d3.timeParse("%Y-%m-%d");
                            
                            // set the ranges
                            var x = d3.scaleTime().range([20, width-20]);
                            var y = d3.scaleLinear().range([height, 0]);
                            var x= d3.scaleTime()
                                .domain([new Date(2014, 0, 1), new Date(2016, 0, 1, 0)])
                                .rangeRound([20,width - 20]);
                                var xAxis2 = d3.axisBottom(x).tickFormat(d3.timeFormat("%Y"));
                            
                            // define the 1st line
                            var valueline = d3.line()
                                .x(function(d) { return x(d.Trade_Dt); })
                                .y(function(d) { return y(d.Fund_Cumulative); });
                            
                            // define the 2nd line
                            var valueline2 = d3.line()
                                .x(function(d) { return x(d.Trade_Dt); })
                                .y(function(d) { return y(d.Cumulative_Return_Benchmark); });
                            
                            // append the svg obgect to the body of the page
                            // appends a 'group' element to 'svg'
                            // moves the 'group' element to the top left margin
                            var svg = d3.select("#centered").append("svg")
                            .attr("viewBox", [0, 0, width+200, height+100])
                                // .attr("width", width + margin.left + margin.right)
                                // .attr("height", height + margin.top + margin.bottom)
                              .append("g")
                                .attr("transform",
                                      "translate(" + margin.left + "," + margin.top + ")");
                            
                            // Get the data
                            // d3.csv("chart1.csv", function(error, data) {
                            //   if (error) throw error;
                            var count=0
                            var data={{data.chart_data|safe}}
                            var count=[]
                              // format the data
                              data.forEach(function(d) {
                                  d.Trade_Dt = parseTime(d.Trade_Dt);
                                 
                                  count.push(d.Trade_Dt.getFullYear())
                                  d.Fund_Cumulative= +d.Fund_Cumulative;
                                  d.Cumulative_Return_Benchmark = +d.Cumulative_Return_Benchmark;
                                  
                              });
                            
                            count = count.filter( function( item, index, inputArray ) {
                                       return inputArray.indexOf(item) == index;
                                });
                            
                            
                              // Scale the range of the data
                            
                              x.domain(d3.extent(data, function(d) { return d.Trade_Dt; }));
                              
                              y.domain([0, d3.max(data, function(d) {
                                  return Math.max(d.Fund_Cumulative, d.Cumulative_Return_Benchmark); })]);
                            
                              // Add the valueline path.
                              svg.append("path")
                                  .data([data])
                                  .attr("class", "line").style("stroke", "green")
                                  .attr("d", valueline);
                            
                              // Add the valueline2 path.
                              svg.append("path")
                                  .data([data])
                                  .attr("class", "line")
                                  .style("stroke", "black")
                                  .attr("d", valueline2);
                            
                              // Add the X Axis
                              svg.append("g")
                                  .attr("transform", "translate(-20," + height + ")").attr("class","axis")  
                                  .call(d3.axisBottom(x).ticks(count.length-1) .tickFormat(d3.timeFormat("%Y")));
                            
                              // Add the Y Axis
                            
                            
                              svg.append("g")  .attr("class","axis")
                                  .call(d3.axisLeft(y).tickFormat(d => "$ "+d ));
                            
                            
                                  svg.append("text")             
                                    .attr("x",-120 )
                                    .attr("y",-80)
                                    .style("text-anchor", "middle")
                                    .attr("transform", "rotate(-90)")
                                    .attr("font-family","Arial Black")
                                    .text("Growth of $1000");
                            
                            // });
                            
                            
                            
                            
                            var colors = ["green", "black"];
                             // Draw legend
                             var legend = svg.selectAll(".legend")
                                                .data(colors)
                                                .enter().append("g")
                                                .attr("class", "legend")
                                                .attr("transform", function(d, i) { return "translate(30," + i * 20 + ")"; });
                                              
                                              legend.append("rect")
                                                .attr("x",width-130)
                                                .attr("y",-40)
                                                .attr("width", 18)
                                                .attr("height", 18)
                                                .style("fill", function(d, i) {return colors.slice().reverse()[i];});
                                              
                                              legend.append("text")
                                                .attr("x",width-110)
                                                .attr("y", -30)
                                                .attr("dy", ".35em")
                                                .style("text-anchor", "start")
                                                .text(function(d, i) { 
                                  
                                                  switch (i) {
                                                    case 0: return "Isomer";
                                                    case 1: return "S&P500";
                                                  
                                                  }
                                                });
                            
                            
                            
                            
                            </script>
                            
                            

                    </div>
                </div>
                <div class="tm-col tm-col-big">
                    <div class="bg-white tm-block h-100">
                        <h2 class="tm-block-title">Portfolio Measurments</h2>
                        <!-- <canvas id="barChart"></canvas> -->
                        <div id="date">
                          <p> Select Date: <input type="text"id="dt"   class="column  month_and_year_option i " name="announcementdate" required placeholder="DD/MM/YYYY" autocomplete="off">
                          </p>
                          <!-- <button id="btn" onclick="getdate()">Submit</button> -->
                      </div>
                      <input type="hidden" id="start" />
        
 <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
<link href="http://cdn-na.infragistics.com/igniteui/latest/css/themes/infragistics/infragistics.theme.css" rel="stylesheet">
<script>


var data={{data2|safe}}  
// console.log(data)
$(function(){
               $( "#dt" ).datepicker({
                   changeMonth : true,
                   changeYear : true,
                   dateFormat : 'mm/dd/yy'
               });
           });
           
    $(function(){
                        $("#dt").on("change",function(){
                        selected_date=$('#dt').val();
                        
                        table_data(selected_date)
                       
    
                            })


});

function table_data(selected_date)
                        {
                        sort_data=data.filter((item) => item.Trade_Dt === selected_date )
                        // console.log(sort_data)
                        data2=sort_data;
                        if(sort_data.length!=0)
                            {
                              if(data2[0]['Annl Fund'])
                            document.getElementById("1").value=data2[0]['Annl Fund']
                        else
                            document.getElementById("1").value=null;

                  
                        if(data2[0]['Annl Benchmark'])
                             document.getElementById("2").value= parseFloat(data2[0]['Annl Benchmark']).toFixed(2)
                        else 
                            document.getElementById("2").value=null;

                  
                        if(data2[0]["Ann'l Fund Vol"])
                             document.getElementById("3").value=data2[0]["Ann'l Fund Vol"]
                        else 
                            document.getElementById("3").value=null;    


                        if(data2[0]["Ann'l Benchmark Vol"])   
                             document.getElementById("4").value=parseFloat(data2[0]["Ann'l Benchmark Vol"]).toFixed(2)
                        else 
                            document.getElementById("4").value=null;

                        if(data2[0]['Max Drawdown - Fund'])
                             document.getElementById("5").value =data2[0]['Max Drawdown - Fund']
                        else 
                            document.getElementById("5").value=null;

                        if(data2[0]['Max Drawdown - Bench Mark'])
                              document.getElementById("6").value=data2[0]['Max Drawdown - Bench Mark']
                        else 
                            document.getElementById("6").value=null;

                        if(data2[0]['Sharpe - Fund'])
                             document.getElementById("7").value =data2[0]['Sharpe - Fund']
                        else 
                            document.getElementById("7").value=null;

                        if(data2[0]['Sharpe - Benchmark'])
                                  document.getElementById("8").value =data2[0]['Sharpe - Benchmark']
                        else 
                            document.getElementById("8").value=null;

                        if(data2[0]['Sortino - Fund'])
                             document.getElementById("9").value =data2[0]['Sortino - Fund']
                        else 
                            document.getElementById("9").value=null;

                        if(data2[0]['Sortino - Benchmark'])
                            document.getElementById("10").value=data2[0]['Sortino - Benchmark']
                        else 
                            document.getElementById("10").value=null;
                            }
                            else
                            {
                            //   alert("Data is not Available for that date !")
                                          document.getElementById("1").value=null;
                                          document.getElementById("2").value=null;
                                          document.getElementById("3").value=null;    
                                          document.getElementById("4").value=null;    
                                          document.getElementById("5").value=null;    
                                          document.getElementById("6").value=null;    
                                          document.getElementById("7").value=null;    
                                          document.getElementById("8").value=null;    
                                          document.getElementById("9").value=null;    
                                          document.getElementById("10").value=null; 
                            }
                        
                        }

</script>
<script>
    $("#id_of_table").width($(window).width());
</script>
                        <table id='id_of_table' style="background: #f5f5f5;
                        background: #f5f5f5;
                        border-collapse: separate;
                        box-shadow: inset 0 1px 0 #fff;
                        font-size: 12px;
                        line-height: 24px;
                        margin: 30px auto;
                        text-align: left;
                        ">
             <tr>
                 
                 <th>      
                 </th>
                 <th>
                     Fund
                 </th>
                 <th>
                     S&P 500
                 </th>
                </tr>
             </th>
                <tr><td>Ann'l Return</td><td><input id="1" type="text"  readonly></td><td><input id="2" type="text" readonly></td></tr>
              
                 <tr><td>Ann'l  Vol</td><td><input type="text" id="3" readonly></td></td><td><input id="4" type="text" readonly ></td></tr>
        
                
                 <tr> <td>Max Drawdown </td><td><input type="text" id="5" readonly></td></td><td><input id="6" type="text"readonly ></td></tr>
                
                 <tr><td>Sharpe  </td><td><input type="text" id="7" readonly></td></td><td><input id="8" type="text" readonly></td></tr>
                    <tr>  <td>Sortino  </td><td><input type="text" id="9" readonly ></td></td><td><input id="10" type="text" readonly></td></tr>
            </table>



                    </div>
                </div>
          

                <div class="tm-col tm-col-bbig">
                    <div class="bg-white tm-block h-100">
                            <h2 class="tm-block-title">Monthly Perfomance</h2>
                        <div  style="float:left;width:90%">
                                                        
                          <table  id="js-datatable"   style="width:70% ;background: #f5f5f5;
                            background: #f5f5f5;
                          border-collapse: separate;
                          box-shadow: inset 0 1px 0 #fff;
                          font-size: 12px;
                          line-height: 24px;
                          margin-left:5% ;
                          text-align: left;
                          width: 82%;float:left">
                              <thead>
                                <th>Year</th>
                                <th>Jan</th>
                                <th>Feb</th>
                                <th>Mar</th>
                                <th>Apr</th>
                                <th>May</th>
                                <th>Jun</th>
                                <th>Jul</th>
                                <th>Aug</th>
                                <th>Sep</th>
                                <th>Oct</th>
                                <th>Nov</th>
                                <th>Dec</th>
                           
                              </thead>
                              
                            
                            </table>
                            
                            <table  style="float:right;width:100px;background: #f5f5f5;
                            background: #f5f5f5;
                          border-collapse: separate;
                          box-shadow: inset 0 1px 0 #fff;
                          font-size: 12px;
                          line-height: 24px;
                         
                          text-align: left;margin-top:0px">
                                
                                  <th>YTD</th>
                                  <tbody id="ytd" >
                                    </tbody>
                                
                                  
                              </table>
                              <b id="insertfirsttable" >
                              </b>
                            <!-- <input type="submit" id="insertitem" > -->
                            <script>
                      
                              // var year={{year|safe}}
                              var ytd={{ytd|safe}}
                              // alert(years.length)
                              for(j=0;j<ytd.length;j++)
                            {
                      
                              var table = document.getElementById('ytd')
                      
                              for (var r = 0; r < 1; r += 1) {
                                var x = document.getElementById('ytd').insertRow(r);
                                for (var c = 0; c < 1; c += 1) {
                                  var y = x.insertCell(c);
                                }
                      
                                table.rows[r].cells[0].innerHTML = ytd[j];
                              }
                            }
                            var margin = {top: 4, right: 0, bottom: 30, left: 170},
                              width = 1240 - margin.left - margin.right,
                              height = 180 - margin.top - margin.bottom;
                      
                            // append the svg object to the body of the page
                            var svg = d3.select("#insertfirsttable")
                            .append("svg").attr("viewBox", [0, 0, width+200, height+100])
                              //   .attr("height", height + margin.top + margin.bottom)  //   .attr("width", width + margin.left + margin.right)
                        
                            .append("g")
                              .attr("transform",
                                    "translate(" + margin.left + "," + margin.top + ")");
                      
                            // Labels of row and columns
                            var myGroups =  ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
                            var myVars = ["2017","2018","2019"]
                      
                            // Build X scales and axis:
                            var x = d3.scaleBand()
                              .range([ 0, width ])
                              .domain(myGroups)
                              .padding(0.01);
                            svg.append("g")
                              .attr("transform", "translate(0," + height + ")");
                              // .call(d3.axisBottom(x))
                      
                            // Build X scales and axis:
                            var y = d3.scaleBand()
                              .range([ height, 0 ])
                              .domain(myVars)
                              .padding(0.01);
                            svg.append("g")  .attr("class", "y axis")
                              .call(d3.axisLeft(y));
                      
                            // Build color scale
                            var myColor = d3.scaleLinear()
                              .range(["#000000", "orange"])
                              .domain([-0.05,0.05])
                            
                            //Read the data
                            d3.csv("../static/csv/chart3.csv", function(data) {
                              // var formatter = d3.format(".0%");
                              svg.selectAll()
                                  .data(data, function(d) {return d.Month+':'+d.Year;})
                                  .enter()
                                  .append("rect")
                                  .attr("x", function(d) { return x(d.Month) })
                                  .attr("y", function(d) { return y(d.Year) })
                                  .attr("width", x.bandwidth() )
                                  .attr("height", y.bandwidth() ) 
                           
                                  .style("fill", function(d) { return myColor(d.value)} )
                             
                                svg.selectAll()
                                  .data(data, function(d) {return d.Month+':'+d.Year;})
                                  .enter()
                                  .append("text")
                                  .attr("x", function(d) { return x(d.Month)+30})
                                  .attr("y", function(d) { return y(d.Year)+20})
                                  .attr("width", x.bandwidth() )
                                  .attr("height", y.bandwidth() ) .style("fill","white")
                                  .text( function(d) {
                                    if(d.value) 
                                    {
                                      num=d.value;y=parseFloat(num).toFixed(2);return y+"%";
                                    }
                                    else
                                    return null;
                                    })
                                  
                                  
                      
                            })
        
                          
                                     
                            </script>
                            </div>
                    </div>
                </div>
            
              
           
        </div>
        </div>
    </div>
</body>
</html>
   <!-- ALL JS FILES -->
   <script src="{% static 'static/js/all.js' %}"></script>
   <!-- ALL PLUGINS -->
   <script src="{% static 'static/js/custom.js' %}"></script>